```JSX
import { useEffect, useState } from 'react';
import { getFoods } from '../api';
import FoodList from './FoodList';

function App() {
  const [order, setOrder] = useState('createdAt');
  const [cursor, setCursor] = useState(null);
  const [items, setItems] = useState([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState();

  const handleNewestClick = () => setOrder('createdAt');

  const handleCalorieClick = () => setOrder('calorie');

  const handleDelete = (id) => {
    const nextItems = items.filter((item) => item.id !== id);
    setItems(nextItems);
  };

  const handleLoad = async (options) => {
    try{
		setError(null);
	    setIsLoading(true);
      const {
        foods,
        paging: { nextCursor },
      } = await getFoods(options);
      if (!options.cursor) {
        setItems(foods);
      } else {
        setItems((prevItems) => [...prevItems, ...foods]);
      }
      setCursor(nextCursor);
    }catch(err){
      setError(err);
    }finally{
      setIsLoading(false);
    }
  };

  const handleLoadMore = () => {
    handleLoad({
      order,
      cursor,
    });
  };

  const sortedItems = items.sort((a, b) => b[order] - a[order]);

  useEffect(() => {
    handleLoad({
      order,
    });
  }, [order]);

  return (
    <div>
      <button onClick={handleNewestClick}>최신순</button>
      <button onClick={handleCalorieClick}>칼로리순</button>
      <FoodList items={sortedItems} onDelete={handleDelete} />
      {cursor && <button disabled={isLoading} onClick={handleLoadMore}>더보기</button>}
      {error && <span>{error.message}</span>}
    </div>
  );
}

export default App;
```

### 로딩 처리

1) try-finally문으로 isLoading 상태(State)를 true/false 통제
2) isLoading이 true인 동안 버튼이 disabled되도록 해서 로딩 중에 중복 클릭 불가하도록 했다.
3) (개발자 도구 Network 탭에서 3G 속도로 설정해주면 로딩이 잘 보인다.)

### 에러 처리
1) catch문으로 에러 메세지를 받아오고
2) error 상태(State)를 만들어서 관리
3) 에러가 있으면 에러메세지를 출력하도록 바꾼다.

```JSX
export async function getFoods({ order = '', cursor = '', limit = 10 }) {
  const query = `order=${order}&cursor=${cursor}&limit=${limit}`;
  const response = await fetch(`https://learn.codeit.kr/foods?${query}`);
  if (!response.ok) {
    throw new Error('데이터를 불러오는데 실패했습니다');
  }
  const body = await response.json();
  return body;
}
```